<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Produtos - Controle de Bobinas 2.0</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <!-- NAVBAR -->
    <nav class="navbar">
        <a href="/" class="navbar-brand">ðŸŽ¯ Controle de Bobinas 2.0</a>
        <ul class="navbar-menu">
            <li><a href="/">Dashboard</a></li>
            <li><a href="/produtos.html" class="active">Produtos</a></li>
            <li><a href="/estoque.html">Estoque</a></li>
            <li><a href="/ordens.html">Ordens de Corte</a></li>
            <li><a href="/configuracoes.html">ConfiguraÃ§Ãµes</a></li>
        </ul>
    </nav>

    <div class="container">
        <div class="card">
            <div class="card-header">
                <h1 class="card-title">ðŸ“¦ Gerenciar Produtos</h1>
            </div>

            <!-- Alertas -->
            <div id="alerta-container"></div>

            <!-- FormulÃ¡rio de Cadastro -->
            <div class="flex flex-between mb-3">
                <h2>Cadastrar Novo Produto</h2>
            </div>
            <form id="form-produto" class="mb-3">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="loja">Loja *</label>
                        <select class="form-control" id="loja" required>
                            <option value="">Selecione...</option>
                            <option value="Cortinave">Cortinave</option>
                            <option value="BN">BN</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="codigo">CÃ³digo *</label>
                        <input type="text" class="form-control" id="codigo" placeholder="Ex: PROD001" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="cor_id">Cor *</label>
                        <select class="form-control" id="cor_id" required>
                            <option value="">Carregando...</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="gramatura_id">Gramatura *</label>
                        <select class="form-control" id="gramatura_id" required>
                            <option value="">Carregando...</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="fabricante">Fabricante *</label>
                        <select class="form-control" id="fabricante" required>
                            <option value="">Selecione...</option>
                            <option value="Propex">Propex</option>
                            <option value="Textiloeste">Textiloeste</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="tipo_tecido">Tipo de Tecido *</label>
                        <select class="form-control" id="tipo_tecido" required onchange="toggleCamposTecido()">
                            <option value="Normal">Normal</option>
                            <option value="Bando Y">Bando Y</option>
                        </select>
                    </div>
                </div>

                <!-- Campo de Metragem ConfiÃ¡vel -->
                <div class="form-row">
                    <div class="form-group" style="grid-column: 1 / -1;">
                        <div class="checkbox-group">
                            <input type="checkbox" id="metragem_confiavel">
                            <label for="metragem_confiavel">
                                <strong>âœ“ Metragem ConfiÃ¡vel</strong>
                                <small style="display: block; color: #666; margin-top: 4px;">
                                    Marque se este produto possui metragens precisas do fornecedor (mÃºltiplos exatos)
                                </small>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Campos para Tecido Normal -->
                <div id="campos-normal" class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="largura_sem_costura">Largura sem costura (cm) *</label>
                        <input type="number" class="form-control" id="largura_sem_costura" step="0.01" min="0" placeholder="Ex: 300">
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="tipo_bainha">Tipo de Bainha *</label>
                        <select class="form-control" id="tipo_bainha">
                            <option value="">Selecione...</option>
                            <option value="Sem Bainha">Sem Bainha</option>
                            <option value="Cano/Cano">Cano/Cano</option>
                            <option value="Cano/Arame">Cano/Arame</option>
                            <option value="Arame/Arame">Arame/Arame</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="largura_final">Largura Final (cm) *</label>
                        <input type="number" class="form-control" id="largura_final" step="0.01" min="0" placeholder="Ex: 298.5" onchange="validarLarguraFinal()">
                        <small id="erro-largura-final" style="color: red; display: none;">Largura final nÃ£o pode ser maior que largura sem costura</small>
                    </div>
                </div>

                <!-- Campos para Bando Y -->
                <div id="campos-bando-y" class="form-row" style="display: none;">
                    <div class="form-group">
                        <label class="form-label" for="largura_maior">Largura Maior (cm) *</label>
                        <input type="number" class="form-control" id="largura_maior" step="0.01" min="0" placeholder="Ex: 350">
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="largura_y">Largura Y (cm) *</label>
                        <input type="number" class="form-control" id="largura_y" step="0.01" min="0" placeholder="Ex: 200">
                    </div>
                </div>

                <button type="submit" class="btn btn-primary">âž• Cadastrar Produto</button>
            </form>
            <!-- Tabela de Produtos -->
            <div class="flex flex-between mb-3">
                <h2>Produtos Cadastrados</h2>
            </div>
            
            <div class="search-box mb-3">
                <input type="text" class="form-control" id="search-produtos" placeholder="ðŸ” Buscar por cÃ³digo, cor, loja..." onkeyup="filtrarProdutos()">
            </div>

            <table class="table" id="tabela-produtos">
                <thead>
                    <tr>
                        <th>Loja</th>
                        <th>CÃ³digo</th>
                        <th>Cor</th>
                        <th>Gramatura</th>
                        <th>Fabricante</th>
                        <th>Tipo</th>
                        <th>Larg. S/Costura</th>
                        <th>Tipo Bainha</th>
                        <th>Larg. Final</th>
                        <th>Larg. Maior</th>
                        <th>Larg. Y</th>
                        <th>Status</th>
                        <th>AÃ§Ãµes</th>
                    </tr>
                    <tr class="filter-row">
                        <th>
                            <div class="multi-select-dropdown">
                                <button type="button" class="btn-multi-select" onclick="toggleDropdown('filtro-loja')">
                                    <span id="filtro-loja-label">Todas</span> â–¼
                                </button>
                                <div class="dropdown-content" id="filtro-loja-dropdown">
                                    <div class="dropdown-item">
                                        <input type="checkbox" id="filtro-loja-todas" value="" onchange="toggleSelectAll('filtro-loja')"> 
                                        <label for="filtro-loja-todas">Todas</label>
                                    </div>
                                    <div id="filtro-loja-opcoes"></div>
                                </div>
                            </div>
                        </th>
                        <th>
                            <input type="text" class="form-control form-control-sm" id="filtro-codigo" placeholder="CÃ³digo..." onkeyup="aplicarFiltros()">
                        </th>
                        <th>
                            <div class="multi-select-dropdown">
                                <button type="button" class="btn-multi-select" onclick="toggleDropdown('filtro-cor')">
                                    <span id="filtro-cor-label">Todas</span> â–¼
                                </button>
                                <div class="dropdown-content" id="filtro-cor-dropdown">
                                    <div class="dropdown-item">
                                        <input type="checkbox" id="filtro-cor-todas" value="" onchange="toggleSelectAll('filtro-cor')"> 
                                        <label for="filtro-cor-todas">Todas</label>
                                    </div>
                                    <div id="filtro-cor-opcoes"></div>
                                </div>
                            </div>
                        </th>
                        <th>
                            <div class="multi-select-dropdown">
                                <button type="button" class="btn-multi-select" onclick="toggleDropdown('filtro-gramatura')">
                                    <span id="filtro-gramatura-label">Todas</span> â–¼
                                </button>
                                <div class="dropdown-content" id="filtro-gramatura-dropdown">
                                    <div class="dropdown-item">
                                        <input type="checkbox" id="filtro-gramatura-todas" value="" onchange="toggleSelectAll('filtro-gramatura')"> 
                                        <label for="filtro-gramatura-todas">Todas</label>
                                    </div>
                                    <div id="filtro-gramatura-opcoes"></div>
                                </div>
                            </div>
                        </th>
                        <th>
                            <div class="multi-select-dropdown">
                                <button type="button" class="btn-multi-select" onclick="toggleDropdown('filtro-fabricante')">
                                    <span id="filtro-fabricante-label">Todos</span> â–¼
                                </button>
                                <div class="dropdown-content" id="filtro-fabricante-dropdown">
                                    <div class="dropdown-item">
                                        <input type="checkbox" id="filtro-fabricante-todas" value="" onchange="toggleSelectAll('filtro-fabricante')"> 
                                        <label for="filtro-fabricante-todas">Todos</label>
                                    </div>
                                    <div id="filtro-fabricante-opcoes"></div>
                                </div>
                            </div>
                        </th>
                        <th>
                            <div class="multi-select-dropdown">
                                <button type="button" class="btn-multi-select" onclick="toggleDropdown('filtro-tipo')">
                                    <span id="filtro-tipo-label">Todos</span> â–¼
                                </button>
                                <div class="dropdown-content" id="filtro-tipo-dropdown">
                                    <div class="dropdown-item">
                                        <input type="checkbox" id="filtro-tipo-todas" value="" onchange="toggleSelectAll('filtro-tipo')"> 
                                        <label for="filtro-tipo-todas">Todos</label>
                                    </div>
                                    <div id="filtro-tipo-opcoes">
                                        <div class="dropdown-item">
                                            <input type="checkbox" class="filtro-tipo-checkbox" value="Normal" onchange="aplicarFiltrosMultiplos('filtro-tipo')"> 
                                            <label>Normal</label>
                                        </div>
                                        <div class="dropdown-item">
                                            <input type="checkbox" class="filtro-tipo-checkbox" value="Bando Y" onchange="aplicarFiltrosMultiplos('filtro-tipo')"> 
                                            <label>Bando Y</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </th>
                        <th>
                            <input type="text" class="form-control form-control-sm" id="filtro-larg-sem-costura" placeholder="cm..." onkeyup="aplicarFiltros()">
                        </th>
                        <th>
                            <div class="multi-select-dropdown">
                                <button type="button" class="btn-multi-select" onclick="toggleDropdown('filtro-bainha')">
                                    <span id="filtro-bainha-label">Todas</span> â–¼
                                </button>
                                <div class="dropdown-content" id="filtro-bainha-dropdown">
                                    <div class="dropdown-item">
                                        <input type="checkbox" id="filtro-bainha-todas" value="" onchange="toggleSelectAll('filtro-bainha')"> 
                                        <label for="filtro-bainha-todas">Todas</label>
                                    </div>
                                    <div id="filtro-bainha-opcoes">
                                        <div class="dropdown-item">
                                            <input type="checkbox" class="filtro-bainha-checkbox" value="Sem Bainha" onchange="aplicarFiltrosMultiplos('filtro-bainha')"> 
                                            <label>Sem Bainha</label>
                                        </div>
                                        <div class="dropdown-item">
                                            <input type="checkbox" class="filtro-bainha-checkbox" value="Cano/Cano" onchange="aplicarFiltrosMultiplos('filtro-bainha')"> 
                                            <label>Cano/Cano</label>
                                        </div>
                                        <div class="dropdown-item">
                                            <input type="checkbox" class="filtro-bainha-checkbox" value="Cano/Arame" onchange="aplicarFiltrosMultiplos('filtro-bainha')"> 
                                            <label>Cano/Arame</label>
                                        </div>
                                        <div class="dropdown-item">
                                            <input type="checkbox" class="filtro-bainha-checkbox" value="Arame/Arame" onchange="aplicarFiltrosMultiplos('filtro-bainha')"> 
                                            <label>Arame/Arame</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </th>
                        <th>
                            <input type="text" class="form-control form-control-sm" id="filtro-larg-final" placeholder="cm..." onkeyup="aplicarFiltros()">
                        </th>
                        <th>
                            <input type="text" class="form-control form-control-sm" id="filtro-larg-maior" placeholder="cm..." onkeyup="aplicarFiltros()">
                        </th>
                        <th>
                            <input type="text" class="form-control form-control-sm" id="filtro-larg-y" placeholder="cm..." onkeyup="aplicarFiltros()">
                        </th>
                        <th>
                            <div class="multi-select-dropdown">
                                <button type="button" class="btn-multi-select" onclick="toggleDropdown('filtro-status')">
                                    <span id="filtro-status-label">Todos</span> â–¼
                                </button>
                                <div class="dropdown-content" id="filtro-status-dropdown">
                                    <div class="dropdown-item">
                                        <input type="checkbox" id="filtro-status-todas" value="" onchange="toggleSelectAll('filtro-status')"> 
                                        <label for="filtro-status-todas">Todos</label>
                                    </div>
                                    <div id="filtro-status-opcoes">
                                        <div class="dropdown-item">
                                            <input type="checkbox" class="filtro-status-checkbox" value="1" onchange="aplicarFiltrosMultiplos('filtro-status')"> 
                                            <label>Ativo</label>
                                        </div>
                                        <div class="dropdown-item">
                                            <input type="checkbox" class="filtro-status-checkbox" value="0" onchange="aplicarFiltrosMultiplos('filtro-status')"> 
                                            <label>Inativo</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </th>
                        <th></th>
                    </tr>
                </thead>
                <tbody id="lista-produtos">
                    <tr>
                        <td colspan="13" class="text-center">Carregando produtos...</td>
                    </tr>
                </tbody>
            </table>

            <div id="empty-produtos" class="empty-state" style="display: none;">
                <div class="empty-state-icon">ðŸ“¦</div>
                <h3>Nenhum produto cadastrado</h3>
                <p>Preencha o formulÃ¡rio acima para comeÃ§ar</p>
            </div>
        </div>
    </div>

    <style>
        .filter-row th {
            padding: 5px;
            background-color: #f8f9fa;
        }
        .filter-row .form-control-sm {
            font-size: 0.875rem;
            height: calc(1.5em + 0.5rem + 2px);
        }
        
        /* Multi-select dropdown styles */
        .multi-select-dropdown {
            position: relative;
            width: 100%;
        }
        
        .btn-multi-select {
            width: 100%;
            padding: 0.25rem 0.5rem;
            font-size: 0.875rem;
            background-color: white;
            border: 1px solid #ced4da;
            border-radius: 0.2rem;
            text-align: left;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .btn-multi-select:hover {
            background-color: #f8f9fa;
        }
        
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: white;
            min-width: 200px;
            max-height: 250px;
            overflow-y: auto;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1000;
            border: 1px solid #ced4da;
            border-radius: 0.2rem;
        }
        
        .dropdown-content.show {
            display: block;
        }
        
        .dropdown-item {
            padding: 8px 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .dropdown-item:hover {
            background-color: #f8f9fa;
        }
        
        .dropdown-item input[type="checkbox"] {
            cursor: pointer;
        }
        
        .dropdown-item label {
            cursor: pointer;
            margin: 0;
            flex: 1;
            user-select: none;
        }
    </style>

    <script src="/js/produtos.js"></script>
</body>
</html>
